+ set -euo pipefail
+ trap 'echo "‚ùå Errore a linea $LINENO"; exit 1' ERR
+++ dirname /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/2_mysql_setup.sh
++ cd /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts
++ pwd
+ SCRIPT_DIR=/mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts
+ source /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../config/wp_installer.cfg
+++ grep -qi microsoft /proc/version
+++ echo true
++ WSL_MODE=true
+++ '[' true = true ']'
+++ echo /run/mysqld/mysqld.sock
++ MYSQL_SOCKET=/run/mysqld/mysqld.sock
+++ '[' true = true ']'
+++ echo service
++ SERVICE_CMD=service
++ DOMAIN=localhost
++ WP_DIR=/var/www/html/wordpress
++ SERVER_PORT=80
++ ADMIN_EMAIL=admin@localhost
++ PHP_VERSION=8.3
++ ENV_MODE=local
++ SSL_TYPE=selfsigned
++ WP_UID=www-data
++ WP_GID=www-data
++ MYSQL_CREDS_DIR=/root/.wp_secure
++ DIR_PERMS=750
++ FILE_PERMS=640
++ MYSQL_CREDS_FILE=/root/.wp_secure/.mysql_creds
++ '[' '!' -d /root/.wp_secure ']'
++ '[' '!' -f /root/.wp_secure/.mysql_creds ']'
++ source /root/.wp_secure/.mysql_creds
+++ MYSQL_ROOT_PASS=gypBXPaO75fHtBjGHabV3UFlRK5GNwkm
+++ MYSQL_WP_USER=wp_user_c43df6
+++ MYSQL_WP_PASS=q/ggtG//eoezyNkK7UiYmMDYIvVJV2TQ
+++ MYSQL_WP_DB=wp_db_794c43
++ '[' -z wp_user_c43df6 ']'
++ '[' -z q/ggtG//eoezyNkK7UiYmMDYIvVJV2TQ ']'
+ LOG_FILE=/mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
+ exec
++ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
+ echo '=== CONFIGURAZIONE DATABASE ==='
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
=== CONFIGURAZIONE DATABASE ===
+ dpkg -l mariadb-server
+ for attempt in {1..3}
+ echo 'üîÑ Tentativo 1 di avvio MariaDB...'
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
üîÑ Tentativo 1 di avvio MariaDB...
+ sudo service start mysql
start: unrecognized service
+ echo '‚ö†Ô∏è Fallito tentativo 1'
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
‚ö†Ô∏è Fallito tentativo 1
+ sleep 5
+ for attempt in {1..3}
+ echo 'üîÑ Tentativo 2 di avvio MariaDB...'
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
üîÑ Tentativo 2 di avvio MariaDB...
+ sudo service start mysql
start: unrecognized service
+ echo '‚ö†Ô∏è Fallito tentativo 2'
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
‚ö†Ô∏è Fallito tentativo 2
+ sleep 5
+ for attempt in {1..3}
+ echo 'üîÑ Tentativo 3 di avvio MariaDB...'
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
üîÑ Tentativo 3 di avvio MariaDB...
+ sudo service start mysql
start: unrecognized service
+ echo '‚ö†Ô∏è Fallito tentativo 3'
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
‚ö†Ô∏è Fallito tentativo 3
+ sleep 5
+ secure_mysql_installation
+ echo 'üîê Configurazione sicura MariaDB...'
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
üîê Configurazione sicura MariaDB...
+ mysql -uroot
+ echo 'üîç Verifica credenziali...'
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
üîç Verifica credenziali...
+ check_mysql_connection root gypBXPaO75fHtBjGHabV3UFlRK5GNwkm
+ local user=root
+ local pass=gypBXPaO75fHtBjGHabV3UFlRK5GNwkm
+ mysql -uroot -pgypBXPaO75fHtBjGHabV3UFlRK5GNwkm -e 'SHOW DATABASES;'
+ return 0
+ check_mysql_connection wp_user_c43df6 q/ggtG//eoezyNkK7UiYmMDYIvVJV2TQ
+ local user=wp_user_c43df6
+ local pass=q/ggtG//eoezyNkK7UiYmMDYIvVJV2TQ
+ mysql -uwp_user_c43df6 -pq/ggtG//eoezyNkK7UiYmMDYIvVJV2TQ -e 'SHOW DATABASES;'
+ return 0
+ echo 'üîç Test operazioni database...'
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
üîç Test operazioni database...
+ mysql -uwp_user_c43df6 -pq/ggtG//eoezyNkK7UiYmMDYIvVJV2TQ -e '
        CREATE TABLE IF NOT EXISTS `wp_db_794c43`.test_creds (
            id INT AUTO_INCREMENT PRIMARY KEY,
            test_value VARCHAR(100)
        ENGINE=InnoDB;
        DROP TABLE `wp_db_794c43`.test_creds;'
ERROR 1064 (42000) at line 2: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'ENGINE=InnoDB' at line 4
+ echo '‚ùå Test database fallito'
+ tee -a /mnt/c/Users/Francy/Documents/GitHub/Scripts/wpinstaller/scripts/../logs/mysql_setup.log
‚ùå Test database fallito
+ exit 1
